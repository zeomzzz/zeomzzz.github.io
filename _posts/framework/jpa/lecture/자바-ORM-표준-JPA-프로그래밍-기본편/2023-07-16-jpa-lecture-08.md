---
title:  "[ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸] 08ê°•. í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬"
excerpt: "ìˆ˜ê°• ì¤‘"

categories:
  - JPA
tags:
  - [Framework, Lecture, JPA]

toc: true
toc_sticky: true
 
date: 2023-07-16
last_modified_at: 2023-07-16
---

<br>

# **08ê°•. í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬**

<br>

## **01. í”„ë¡ì‹œ**

<br>    

### **í”„ë¡ì‹œ ê¸°ì´ˆ**

<br>

- `em.find()` vs `em.getReference()`
    - `em.find()`: ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
    - `em.getReference()`: ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê°€ì§œ(í”„ë¡ì‹œ) ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
        - DBì— ì¿¼ë¦¬ê°€ ë‚˜ê°€ì§€ ì•ŠëŠ”ë° ê°ì²´ê°€ ì¡°íšŒë¨
        - targetì´ ì§„ì§œ referenceë¥¼ ê°€ë¦¬í‚´
            
            ![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/01.png ){: .align-center}
            
- ì˜ˆì œ
    - getReference
        
        ```java
        Member member = new Member();
        member.setUsername("hello");
        
        em.persist(member);
        
        em.flush();
        em.clear();
        
        Member findMember = em.getReference(Member.class, member.getId());
        
        tx.commit();
        ```
        
        ```java
        Hibernate: 
            /* insert hellojpa.Member
                */ insert 
                into
                    Member
                    (createdBy, createdDate, lastModifiedBy, lastModifiedDate, USERNAME, MEMBER_ID) 
                values
                    (?, ?, ?, ?, ?, ?)
        ```
        
    - getReference + ?
        
        ```java
        Member member = new Member();
        member.setUsername("hello");
        
        em.persist(member);
        
        em.flush();
        em.clear();
        
        Member findMember = em.getReference(Member.class, member.getId());
        
        System.out.println("findMember.id = " + findMember.getId()); // íŒŒë¼ë¯¸í„°ë¡œ ë„£ì€ IDëŠ” DBì— ê°€ì§€ ì•Šì•„ë„ ì•Œ ìˆ˜ ìˆìŒ
        System.out.println("findMember.username = " + findMember.getUsername()); // Usernameì€ DBì— ìˆìŒ. Referenceì— ì—†ì–´ì„œ DBì— ì¿¼ë¦¬ë¥¼ ë‚ ë¦¼
        
        tx.commit();
        ```
        
        ```java
        Hibernate: 
            /* insert hellojpa.Member
                */ insert 
                into
                    Member
                    (createdBy, createdDate, lastModifiedBy, lastModifiedDate, USERNAME, MEMBER_ID) 
                values
                    (?, ?, ?, ?, ?, ?)
        findMember.id = 1 // DBì—ì„œ ê°€ì ¸ì˜¤ì§€ ì•Šì•„ë„ ë¨
        Hibernate: // DB ì°ê³  ê°€ì ¸ì˜´
            select
                member0_.MEMBER_ID as MEMBER_I1_3_0_,
                member0_.createdBy as createdB2_3_0_,
                member0_.createdDate as createdD3_3_0_,
                member0_.lastModifiedBy as lastModi4_3_0_,
                member0_.lastModifiedDate as lastModi5_3_0_,
                member0_.TEAM_ID as TEAM_ID7_3_0_,
                member0_.USERNAME as USERNAME6_3_0_,
                team1_.TEAM_ID as TEAM_ID1_7_1_,
                team1_.createdBy as createdB2_7_1_,
                team1_.createdDate as createdD3_7_1_,
                team1_.lastModifiedBy as lastModi4_7_1_,
                team1_.lastModifiedDate as lastModi5_7_1_,
                team1_.name as name6_7_1_ 
            from
                Member member0_ 
            left outer join
                Team team1_ 
                    on member0_.TEAM_ID=team1_.TEAM_ID 
            where
                member0_.MEMBER_ID=?
        findMember.username = hello
        ```
        
    - findMemberëŠ” Proxy
        
        ```java
        Member member = new Member();
        member.setUsername("hello");
        
        em.persist(member);
        
        em.flush();
        em.clear();
        
        Member findMember = em.getReference(Member.class, member.getId());
        
        System.out.println("findMember = " + findMember.getClass());
        ```
        
        ```java
        Hibernate: 
            /* insert hellojpa.Member
                */ insert 
                into
                    Member
                    (createdBy, createdDate, lastModifiedBy, lastModifiedDate, USERNAME, MEMBER_ID) 
                values
                    (?, ?, ?, ?, ?, ?)
        findMember = class hellojpa.Member$HibernateProxy$LDM2UMzq
        ```
        
        - findMemberëŠ” Memberê°€ ì•„ë‹ˆê³  `Member$HibernateProxy` : Hibernateê°€ ë§Œë“  ê°€ì§œ Proxy

<br>
<br>

### **í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”**

<br>

```java
Member member = em.getReference(Member.class, â€œid1â€);
member.getName();
```
![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/02.png ){: .align-center}

ex. 

memberëŠ” í”„ë¡ì‹œ ê°ì²´ë¥¼ ê°€ì ¸ì˜¨ ìƒíƒœ

1. member.getName()ì„ í˜¸ì¶œ
2. ì²˜ìŒì— Proxyë¥¼ ë´¤ëŠ”ë°, targetì— ê°’ì´ ì—†ìŒ
3. JPAê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìš”ì²­ : member ê°ì²´ ê°€ì ¸ì™€ : ì´ˆê¸°í™” ìš”ì²­ !!
4. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ DB ì¡°íšŒí•´ì„œ ì‹¤ì œ Entity ê°ì²´ë¥¼ ìƒì„±í•´ì„œ Memberë¥¼ ëŒë ¤ì£¼ê³  targetì— ì—°ê²°
5. ì´ì œ getName() í•˜ë©´ targetì˜ getName()ì„ í†µí•´ Memberì˜ getName()ì„ ë°˜í™˜

<br>
<br>

### **í”„ë¡ì‹œì˜ íŠ¹ì§•**

<br>

- ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì§ -> ì‹¤ì œ í´ë˜ìŠ¤ì™€ ê²‰ëª¨ì–‘ì´ ê°™ìŒ
- ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì§„ì§œ ê°ì²´ì¸ì§€ í”„ë¡ì‹œ ê°ì²´ì¸ì§€ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ë©´ ë¨(ì´ë¡ ìƒ)
- í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°(target)ë¥¼ ë³´ê´€
- í”„ë¡ì‹œ ê°ì²´ë¥¼ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œ
    
    ![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/03.png ){: .align-center}
    
    - ex. getName()ì„ í˜¸ì¶œí•˜ë©´ targetì— ìˆëŠ” getName()ì„ í˜¸ì¶œ
    - ì²˜ìŒì—ëŠ” target ë¹„ì–´ ìˆìŒ : DBì—ì„œ ì¡°íšŒí•œ ì ì´ ì—†ìœ¼ë‹ˆê¹Œ
- í”„ë¡ì‹œ ê°ì²´ëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”
    - í•œ ë²ˆ ì´ˆê¸°í™”í•˜ë©´ ê³„ì† ì‚¬ìš©
- í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ, í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜!!!
    - ì´ˆê¸°í™”ë˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼ ê°€ëŠ¥í•œ ê²ƒ
    - ì˜ˆì œ : before findMemberì™€ after findMemberê°€ ë™ì¼
        
        ```java
        Member member = new Member();
        member.setUsername("hello");
        
        em.persist(member);
        
        em.flush();
        em.clear();
        
        Member findMember = em.getReference(Member.class, member.getId());
        
        System.out.println("before findMember = " + findMember.getClass());
        System.out.println("findMember.username = " + findMember.getUsername());
        System.out.println("after findMember = " + findMember.getClass());
        
        tx.commit();
        ```
        
        ```java
        Hibernate: 
            /* insert hellojpa.Member
                */ insert 
                into
                    Member
                    (createdBy, createdDate, lastModifiedBy, lastModifiedDate, USERNAME, MEMBER_ID) 
                values
                    (?, ?, ?, ?, ?, ?)
        before findMember = class hellojpa.Member$HibernateProxy$L2EuOtQa
        Hibernate: 
            select
                member0_.MEMBER_ID as MEMBER_I1_3_0_,
                member0_.createdBy as createdB2_3_0_,
                member0_.createdDate as createdD3_3_0_,
                member0_.lastModifiedBy as lastModi4_3_0_,
                member0_.lastModifiedDate as lastModi5_3_0_,
                member0_.TEAM_ID as TEAM_ID7_3_0_,
                member0_.USERNAME as USERNAME6_3_0_,
                team1_.TEAM_ID as TEAM_ID1_7_1_,
                team1_.createdBy as createdB2_7_1_,
                team1_.createdDate as createdD3_7_1_,
                team1_.lastModifiedBy as lastModi4_7_1_,
                team1_.lastModifiedDate as lastModi5_7_1_,
                team1_.name as name6_7_1_ 
            from
                Member member0_ 
            left outer join
                Team team1_ 
                    on member0_.TEAM_ID=team1_.TEAM_ID 
            where
                member0_.MEMBER_ID=?
        findMember.username = hello
        after findMember = class hellojpa.Member$HibernateProxy$L2EuOtQa
        ```
        
- í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì† ë°›ìŒ. ë”°ë¼ì„œ íƒ€ì… ì²´í¬ì‹œ == ê°€ ì•„ë‹Œ instanceof ë¡œ ë¹„êµ
    - ì˜ˆì œ
        - find ê²°ê³¼ë¥¼ ë¹„êµ
            
            ```java
            Member member1 = new Member();
            member1.setUsername("member1");
            em.persist(member1);
            
            Member member2 = new Member();
            member2.setUsername("member2");
            em.persist(member2);
            
            em.flush();
            em.clear();
            
            Member m1 = em.find(Member.class, member1.getId());
            Member m2 = em.find(Member.class, member2.getId());
            
            System.out.println("m1 == m2 : " + (m1.getClass() == m2.getClass())); // true
            
            tx.commit();
            ```
            
        - find ì™€ getReference ê²°ê³¼ë¥¼ ë¹„êµ
            - ì‹¤ì œë¡œ proxyê°€ ë„˜ì–´ì˜¬ì§€ ì‹¤ì œ ê°ì²´ê°€ ë„˜ì–´ì˜¬ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì ˆëŒ€ ==ìœ¼ë¡œ type ë¹„êµë¥¼ í•˜ë©´ ì•ˆë¨
                
                ```java
                Member member1 = new Member();
                member1.setUsername("member1");
                em.persist(member1);
                
                Member member2 = new Member();
                member2.setUsername("member2");
                em.persist(member2);
                
                em.flush();
                em.clear();
                
                Member m1 = em.find(Member.class, member1.getId());
                Member m2 = em.getReference(Member.class, member2.getId());
                
                System.out.println("m1 == m2 : " + (m1.getClass() == m2.getClass())); // false (type ë¹„êµì—¬ì„œ)
                
                tx.commit();
                ```
                
            - instanceofë¡œ ë¹„êµ
                
                ```java
                Member member1 = new Member();
                member1.setUsername("member1");
                em.persist(member1);
                
                Member member2 = new Member();
                member2.setUsername("member2");
                em.persist(member2);
                
                em.flush();
                em.clear();
                
                Member m1 = em.find(Member.class, member1.getId());
                Member m2 = em.getReference(Member.class, member2.getId());
                
                logic(m1, m2);
                // m1 == m2 : true
                // m1 == m2 : true
                ```
                
- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜
    - ì˜ˆì œ
        
        ```java
        Member member1 = new Member();
        member1.setUsername("member1");
        em.persist(member1);
        
        em.flush();
        em.clear();
        
        Member m1 = em.find(Member.class, member1.getId());
        System.out.println("m1 = " + m1.getClass()); // m1 = class hellojpa.Member
        
        // í˜„ì¬ m1ì´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë¼ê°€ ìˆëŠ” ìƒíƒœ
        Member reference = em.getReference(Member.class, member1.getId());
        System.out.println("reference = " + reference.getClass()); // reference = class hellojpa.Member
        
        tx.commit();
        ```
        
        - ì´ìœ 
            1. JPAëŠ” í•œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒì„ ë¹„êµí•˜ë©´ í•­ìƒ trueë¥¼ ë°˜í™˜ì„ ë³´ì¥
            2. ì´ë¯¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë¼ì™€ìˆëŠ”ë° Proxyë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì´ì ì´ ì—†ìŒ
- í•œ ë²ˆ Proxyë¥¼ ì¡°íšŒí•˜ë©´ em.findì—ì„œë„ Proxyë¥¼ ë°˜í™˜
    
    ```java
    Member member1 = new Member();
    member1.setUsername("member1");
    em.persist(member1);
    
    em.flush();
    em.clear();
    
    Member refMember = em.getReference(Member.class, member1.getId());
    System.out.println("refMember = " + refMember.getClass()); // refMember = class hellojpa.Member$HibernateProxy$WmuYKyAh
    
    Member findMember = em.find(Member.class, member1.getId());
    System.out.println("findMember = " + findMember.getClass()); // findMember = class hellojpa.Member$HibernateProxy$WmuYKyAh
    // findMember í–ˆëŠ”ë° Proxyë¥¼ ë°˜í™˜
    // ì™œëƒí•˜ë©´,, í•œ ë²ˆ Proxyë¥¼ ì¡°íšŒí•˜ë©´ em.findì—ì„œ Proxyë¥¼ ë°˜í™˜
    
    System.out.println("refMember == findMember : " + (refMember == findMember)); // refMember == findMember : true
    
    tx.commit();
    ```
    
- â­ï¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ ë¬¸ì œ ë°œìƒ (HibernateëŠ” `org.hibernate.LazyInitializationException` ì˜ˆì™¸)
    
    ```java
    try {
    
    		Member member1 = new Member();
    	  member1.setUsername("member1");
    	  em.persist(member1);
    
    		em.flush();
    		em.clear();
    
    		Member refMember = em.getReference(Member.class, member1.getId());
    		System.out.println("refMember = " + refMember.getClass()); // Proxy
    
    		em.detach(refMember); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ êº¼ë‚´ë²„ë¦¼
    		// em.close(); // ì´ê±°ë„ ë§ˆì°¬ê°€ì§€
    		// em.clear();
    
    		refMember.getUsername();
    		// ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì•„ì„œ ì´ˆê¸°í™”í•´ì•¼í•˜ëŠ”ë° ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬í•˜ì§€ ì•Šê³  ìˆìŒ
    		// ë”°ë¼ì„œ could not initialize proxy
    
    		tx.commit();
    
    } catch (Exception e) {
    
    		tx.rollback();
    		e.printStackTrace();
    
    } finally {
    
    		em.close();
    
    }
    ```

<br>
<br>

### **í”„ë¡ì‹œ í™•ì¸**

<br>

- í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸ : `emf.getPersistenceUnitUtil().isLoaded(Object entity)`
    - ì´ˆê¸°í™” ì „
        
        ```java
        Member member1 = new Member();
        member1.setUsername("member1");
        em.persist(member1);
        
        em.flush();
        em.clear();
        
        Member refMember = em.getReference(Member.class, member1.getId());
        System.out.println("refMember = " + refMember.getClass()); // Proxy
        
        System.out.println("isLoaded = " + emf.getPersistenceUnitUtil().isLoaded(refMember)); // false
        
        tx.commit();
        ```
        
    - ì´ˆê¸°í™” í›„
        
        ```java
        Member member1 = new Member();
        member1.setUsername("member1");
        em.persist(member1);
        
        em.flush();
        em.clear();
        
        Member refMember = em.getReference(Member.class, member1.getId());
        System.out.println("refMember = " + refMember.getClass()); // Proxy
        refMember.getUsername(); // ì´ˆê¸°í™”
        System.out.println("isLoaded = " + emf.getPersistenceUnitUtil().isLoaded(refMember)); // true
        
        tx.commit();
        ```
        
- í”„ë¡ì‹œ í´ë˜ìŠ¤ í™•ì¸ ë°©ë²• : `entity.getClass().getName()` ì¶œë ¥
    
    ```java
    Member member1 = new Member();
    member1.setUsername("member1");
    em.persist(member1);
    
    em.flush();
    em.clear();
    
    Member refMember = em.getReference(Member.class, member1.getId());
    System.out.println("refMember = " + refMember.getClass()); // refMember = class hellojpa.Member$HibernateProxy$bPWWO9Gu
    
    tx.commit();
    ```
    
- í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™” : `org.hibernate.Hibernate.initialize(entity);`
    
    ```java
    Member member1 = new Member();
    member1.setUsername("member1");
    em.persist(member1);
    
    em.flush();
    em.clear();
    
    Member refMember = em.getReference(Member.class, member1.getId());
    System.out.println("refMember = " + refMember.getClass());
    
    Hibernate.initialize(refMember);
    
    tx.commit();
    ```
    
    ```java
    Hibernate: 
        call next value for hibernate_sequence
    Hibernate: 
        /* insert hellojpa.Member
            */ insert 
            into
                Member
                (createdBy, createdDate, lastModifiedBy, lastModifiedDate, USERNAME, MEMBER_ID) 
            values
                (?, ?, ?, ?, ?, ?)
    refMember = class hellojpa.Member$HibernateProxy$X96OXpP5
    Hibernate: 
        select
            member0_.MEMBER_ID as MEMBER_I1_3_0_,
            member0_.createdBy as createdB2_3_0_,
            member0_.createdDate as createdD3_3_0_,
            member0_.lastModifiedBy as lastModi4_3_0_,
            member0_.lastModifiedDate as lastModi5_3_0_,
            member0_.TEAM_ID as TEAM_ID7_3_0_,
            member0_.USERNAME as USERNAME6_3_0_,
            team1_.TEAM_ID as TEAM_ID1_7_1_,
            team1_.createdBy as createdB2_7_1_,
            team1_.createdDate as createdD3_7_1_,
            team1_.lastModifiedBy as lastModi4_7_1_,
            team1_.lastModifiedDate as lastModi5_7_1_,
            team1_.name as name6_7_1_ 
        from
            Member member0_ 
        left outer join
            Team team1_ 
                on member0_.TEAM_ID=team1_.TEAM_ID 
        where
            member0_.MEMBER_ID=?
    ```
    
- ì°¸ê³ : JPA í‘œì¤€ì€ ê°•ì œ ì´ˆê¸°í™” ì—†ìŒ
    - ê°•ì œ í˜¸ì¶œ : `member.getName()`

<br>
<br>

## **02. ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©**

<br>

### **ì§€ì—° ë¡œë”© LAZYì„ ì‚¬ìš©í•´ì„œ í”„ë¡ì‹œë¡œ ì¡°íšŒ**

<br>

**ì§€ì—° ë¡œë”©**

![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/04.png ){: .align-center}

- ì§€ì—° ë¡œë”© : í”„ë¡ì‹œì—ì„œë§Œ ì¡°íšŒ
- ì‚¬ìš© ë°©ë²• : `fetch = FetchType.*LAZY*`

```java
@Entity
public class Member {

		@Id
		@GeneratedValue
		private Long id;

		@Column(name = "USERNAME")
		private String name;

		@ManyToOne(fetch = FetchType.LAZY) //**
		@JoinColumn(name = "TEAM_ID")
		private Team team;
		..
 }
```

JpaMain.java

```java
// ìƒëµ

Member m = em.find(Member.class, member1.getId());

System.out.println("m = " + m.getTeam().getClass()); // m = class hellojpa.Team$HibernateProxy$vrnrtZ7q (Proxy)

System.out.println("===============");
m.getTeam().getName(); // ì—¬ê¸°ì„œ ì¿¼ë¦¬ê°€ ë‚˜ê°!!

tx.commit();
```

```java
Hibernate: 
    call next value for hibernate_sequence
Hibernate: 
    call next value for hibernate_sequence
Hibernate: 
    /* insert hellojpa.Team
        */ insert 
        into
            Team
            (createdBy, createdDate, lastModifiedBy, lastModifiedDate, name, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert hellojpa.Member
        */ insert 
        into
            Member
            (createdBy, createdDate, lastModifiedBy, lastModifiedDate, TEAM_ID, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    select
        member0_.MEMBER_ID as MEMBER_I1_3_0_,
        member0_.createdBy as createdB2_3_0_,
        member0_.createdDate as createdD3_3_0_,
        member0_.lastModifiedBy as lastModi4_3_0_,
        member0_.lastModifiedDate as lastModi5_3_0_,
        member0_.TEAM_ID as TEAM_ID7_3_0_,
        member0_.USERNAME as USERNAME6_3_0_ 
    from
        Member member0_ 
    where
        member0_.MEMBER_ID=?
m = class hellojpa.Team$HibernateProxy$vrnrtZ7q
===============
Hibernate: 
    select
        team0_.TEAM_ID as TEAM_ID1_7_0_,
        team0_.createdBy as createdB2_7_0_,
        team0_.createdDate as createdD3_7_0_,
        team0_.lastModifiedBy as lastModi4_7_0_,
        team0_.lastModifiedDate as lastModi5_7_0_,
        team0_.name as name6_7_0_ 
    from
        Team team0_ 
    where
        team0_.TEAM_ID=?
```

<br>
<br>

**ì§€ì—° ë¡œë”© LAZYì„ ì‚¬ìš©í•´ì„œ í”„ë¡ì‹œë¡œ ì¡°íšŒ**

<br>

![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/05.png ){: .align-center}

```java
Member member = em.find(Member.class, 1L);
```

![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/06.png ){: .align-center}

```java
Team team = member.getTeam();
team.getName(); // ì‹¤ì œ teamì„ ì‚¬ìš©í•˜ëŠ” ì‹œì ì— ì´ˆê¸°í™”(DB ì¡°íšŒ)
```

<br>
<br>

### **ì¦‰ì‹œ ë¡œë”© EAGERë¥¼ ì‚¬ìš©í•´ì„œ í•¨ê»˜ ì¡°íšŒ**
 : Memberì™€ Teamì„ ìì£¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

<br>

**ì¦‰ì‹œ ë¡œë”©**

<br>

![]({{ site.url }}{{ site.baseurl }}/assets/images/jpa/lecture/orm/08/07.png ){: .align-center}

- member1ë¥¼ ë¡œë”©í•  ë•Œ team1ê¹Œì§€ joiní•´ì„œ í•œ ë²ˆì— ê°€ì ¸ì˜´


```java
@Entity
public class Member {

		@Id
		@GeneratedValue
		private Long id;

		@Column(name = "USERNAME")
		private String name;

		@ManyToOne(fetch = FetchType.EAGER) //**
		@JoinColumn(name = "TEAM_ID")
		private Team team;
		..
 }
```

JpaMain.java

```java
// ìƒëµ

Member m = em.find(Member.class, member1.getId());

System.out.println("m = " + m.getTeam().getClass()); // m = class hellojpa.Team

tx.commit();
```

ì‹¤í–‰ ê²°ê³¼

- ì¦‰ì‹œ ë¡œë”©ì´ê¸° ë•Œë¬¸ì— Proxyê°€ í•„ìš”í•˜ì§€ ì•Šê³  í•œ ë²ˆì— ë‹¤ ë•¡ê²¨ì˜´

```java
Hibernate: 
    /* insert hellojpa.Team
        */ insert 
        into
            Team
            (createdBy, createdDate, lastModifiedBy, lastModifiedDate, name, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert hellojpa.Member
        */ insert 
        into
            Member
            (createdBy, createdDate, lastModifiedBy, lastModifiedDate, TEAM_ID, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    select
        member0_.MEMBER_ID as MEMBER_I1_3_0_,
        member0_.createdBy as createdB2_3_0_,
        member0_.createdDate as createdD3_3_0_,
        member0_.lastModifiedBy as lastModi4_3_0_,
        member0_.lastModifiedDate as lastModi5_3_0_,
        member0_.TEAM_ID as TEAM_ID7_3_0_,
        member0_.USERNAME as USERNAME6_3_0_,
        team1_.TEAM_ID as TEAM_ID1_7_1_,
        team1_.createdBy as createdB2_7_1_,
        team1_.createdDate as createdD3_7_1_,
        team1_.lastModifiedBy as lastModi4_7_1_,
        team1_.lastModifiedDate as lastModi5_7_1_,
        team1_.name as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
m = class hellojpa.Team
==============
```

<br>
<br>

### **í”„ë¡ì‹œì™€ ì¦‰ì‹œë¡œë”© ì£¼ì˜**

<br>

- ê°€ê¸‰ì  ì§€ì—° ë¡œë”©ë§Œ ì‚¬ìš©(íŠ¹íˆ ì‹¤ë¬´ì—ì„œ)
    - ì¦‰ì‹œ ë¡œë”©ì„ ì ìš©í•˜ë©´ ì˜ˆìƒí•˜ì§€ ëª»í•œ SQLì´ ë°œìƒ
- ì¦‰ì‹œ ë¡œë”©ì€ JPQLì—ì„œ N+1 ë¬¸ì œë¥¼ ì¼ìœ¼í‚´
    - N+1 ë¬¸ì œ : ìµœì´ˆë¡œ ë‚˜ê°„ ì¿¼ë¦¬(1) ë•Œë¬¸ì— ì¶”ê°€ ì¿¼ë¦¬ê°€ ë°œìƒ(N)
    
    ex.
    
    ```java
    Team teamA = new Team();
    teamA.setName("teamA");
    em.persist(teamA);
    
    Team teamB = new Team();
    teamB.setName("teamB");
    em.persist(teamB);
    
    Member member1 = new Member();
    member1.setUsername("member1");
    member1.setTeam(teamA);
    em.persist(member1);
    
    Member member2 = new Member();
    member2.setUsername("member2");
    member2.setTeam(teamB);
    em.persist(member2);
    
    em.flush();
    em.clear();
    
    List<Member> members = em.createQuery("select m from Member m", Member.class).getResultList();
    
    tx.commit();
    ```
    
    ```java
    Hibernate: 
        /* select
            m 
        from
            Member m */ select
                member0_.MEMBER_ID as MEMBER_I1_3_,
                member0_.createdBy as createdB2_3_,
                member0_.createdDate as createdD3_3_,
                member0_.lastModifiedBy as lastModi4_3_,
                member0_.lastModifiedDate as lastModi5_3_,
                member0_.TEAM_ID as TEAM_ID7_3_,
                member0_.USERNAME as USERNAME6_3_ 
            from
                Member member0_
    Hibernate: 
        select
            team0_.TEAM_ID as TEAM_ID1_7_0_,
            team0_.createdBy as createdB2_7_0_,
            team0_.createdDate as createdD3_7_0_,
            team0_.lastModifiedBy as lastModi4_7_0_,
            team0_.lastModifiedDate as lastModi5_7_0_,
            team0_.name as name6_7_0_ 
        from
            Team team0_ 
        where
            team0_.TEAM_ID=?
    Hibernate: 
        select
            team0_.TEAM_ID as TEAM_ID1_7_0_,
            team0_.createdBy as createdB2_7_0_,
            team0_.createdDate as createdD3_7_0_,
            team0_.lastModifiedBy as lastModi4_7_0_,
            team0_.lastModifiedDate as lastModi5_7_0_,
            team0_.name as name6_7_0_ 
        from
            Team team0_ 
        where
            team0_.TEAM_ID=?
    ```
    
    - Memberë¥¼ ì¡°íšŒí•˜ì˜€ëŠ”ë° ì¦‰ì‹œ ë¡œë”© ë•Œë¬¸ì— Teamë„ ë°”ë¡œ ì¡°íšŒ
    - ì§€ì—°ë¡œë”©í•˜ë©´ í”„ë¡ì‹œì—ì„œë§Œ ê°€ì ¸ì˜¬ ê²ƒì„.. (Teamì€ í”„ë¡ì‹œë¡œ ë°•í˜€ìˆìŒ)
        
        ```java
        // @ManyToOne(fetch = FetchType.LAZY)
        Hibernate: 
            /* select
                m 
            from
                Member m */ select
                    member0_.MEMBER_ID as MEMBER_I1_3_,
                    member0_.createdBy as createdB2_3_,
                    member0_.createdDate as createdD3_3_,
                    member0_.lastModifiedBy as lastModi4_3_,
                    member0_.lastModifiedDate as lastModi5_3_,
                    member0_.TEAM_ID as TEAM_ID7_3_,
                    member0_.USERNAME as USERNAME6_3_ 
                from
                    Member member0_
        ```
        
    - ì§€ì—°ë¡œë”© í•´ê²° ë°©ë²•
        - ì¼ë‹¨ ëª¨ë“  ì—°ê´€ ê´€ê³„ë¥¼ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ê¹”ê³ 
        - ë°©ë²• 1. JPQL fetch join : ë™ì ìœ¼ë¡œ ì›í•˜ëŠ” Entityë§Œ ì„ íƒí•´ì„œ ê°€ì ¸ì˜´
            
            ```java
            Team teamA = new Team();
            teamA.setName("teamA");
            em.persist(teamA);
            
            Team teamB = new Team();
            teamB.setName("teamB");
            em.persist(teamB);
            
            Member member1 = new Member();
            member1.setUsername("member1");
            member1.setTeam(teamA);
            em.persist(member1);
            
            Member member2 = new Member();
            member2.setUsername("member2");
            member2.setTeam(teamB);
            em.persist(member2);
            
            em.flush();
            em.clear();
            
            List<Member> members = em.createQuery("select m from Member m join fetch m.team", Member.class).getResultList();
            
            tx.commit();
            ```
            
            ```java
            // ì§€ì—°ë¡œë”©ì´ì§€ë§Œ Memberì™€ Teamì„ joiní•´ì„œ í•œ ë²ˆì— ê°™ì´ ê°€ì ¸ì˜´
            Hibernate: 
                /* select
                    m 
                from
                    Member m 
                join
                    fetch m.team */ select
                        member0_.MEMBER_ID as MEMBER_I1_3_0_,
                        team1_.TEAM_ID as TEAM_ID1_7_1_,
                        member0_.createdBy as createdB2_3_0_,
                        member0_.createdDate as createdD3_3_0_,
                        member0_.lastModifiedBy as lastModi4_3_0_,
                        member0_.lastModifiedDate as lastModi5_3_0_,
                        member0_.TEAM_ID as TEAM_ID7_3_0_,
                        member0_.USERNAME as USERNAME6_3_0_,
                        team1_.createdBy as createdB2_7_1_,
                        team1_.createdDate as createdD3_7_1_,
                        team1_.lastModifiedBy as lastModi4_7_1_,
                        team1_.lastModifiedDate as lastModi5_7_1_,
                        team1_.name as name6_7_1_ 
                    from
                        Member member0_ 
                    inner join
                        Team team1_ 
                            on member0_.TEAM_ID=team1_.TEAM_ID
            ```
            
        - ë°©ë²• 2. `@EntityGraph` annotation
        - ë°©ë²• 3. Batch Size : ì¿¼ë¦¬ê°€ N+1ì´ ì•„ë‹ˆë¼ 1+1ë¡œ ë‚˜ê°
- `@ManyToOne`, `@OneToOne`ì€ ê¸°ë³¸ì´ ì¦‰ì‹œ ë¡œë”© : LAZYë¡œ ì„¤ì •
    - `@OneToMany`, `@ManyToMany`ëŠ” ê¸°ë³¸ì´ ì§€ì—° ë¡œë”©
  

<br>
<br>

## **03. ì˜ì†ì„± ì „ì´ : CASCADE**

<br>

### **ì˜ì†ì„± ì „ì´: CASCADE**

<br>

- (ì—°ê´€ê´€ê³„, ì¦‰ì‹œ ë¡œë”©, ì§€ì—° ë¡œë”©ê³¼ ê´€ê³„ ì—†ìŒ)
- íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ì‹¶ì„ ë•Œ
    
    ex. ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì €ì¥
    

ì˜ˆì œ.

```java

@Entity
public class Parent {

    @Id
    @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent")
    private List<Child> childList = new ArrayList<>();

    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    // getter, setter (ìƒëµ)

}
```

```java

@Entity
public class Child {

    @Id
    @GeneratedValue
    private Long id;

    private String name;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;

    // getter, setter (ìƒëµ)

}
```

```java
Child child1 = new Child();
Child child2 = new Child();

Parent parent = new Parent();
parent.addChild(child1);
parent.addChild(child2);

// persistë¥¼ 3ë²ˆ í•´ì¤˜ì•¼ í•¨. ê·¸ëŸ°ë° ì¢€ ê·€ì°®ì€ë° ..
em.persist(parent);
em.persist(child1);
em.persist(child2);

em.flush();
em.clear();

tx.commit();
```

```java
Hibernate: 
    /* insert hellojpa.Parent
        */ insert 
        into
            Parent
            (name, id) 
        values
            (?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
```

ì´ë•Œ, parentë¥¼ persistí•  ë•Œ childë„ persist ë˜ê²Œ í•˜ë ¤ë©´ : CASCADING

- ì‚¬ìš©ë°©ë²•
    
    ```java
    // Parent.java
    @OneToMany(mappedBy = "parent", cascade = CascadeType.ALL)
    private List<Child> childList = new ArrayList<>();
    ```
    

```java
Child child1 = new Child();
Child child2 = new Child();

Parent parent = new Parent();
parent.addChild(child1);
parent.addChild(child2);

em.persist(parent);

em.flush();
em.clear();

tx.commit();
```

```java
// parentë§Œ persist í–ˆëŠ”ë°, child1, child2ë„ persistë¨
Hibernate: 
    /* insert hellojpa.Parent
        */ insert 
        into
            Parent
            (name, id) 
        values
            (?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
```

<br>
<br>

> ğŸš¨ **ì£¼ì˜**
>
>- ì˜ì†ì„± ì „ì´ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒê³¼ ì•„ë¬´ ê´€ë ¨ X
>- ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì†í™”í•˜ëŠ” í¸ë¦¬í•¨ì„ ì œê³µí•  ë¿
>- ë‹¨ì¼ ì†Œìœ ìì¼ ë•Œë§Œ(ì •ë§ ë¶€ëª¨ê°€ í•˜ë‚˜ì¼ ë•Œ) ì‚¬ìš© ex. parentë§Œ childë¥¼ ê´€ë¦¬. ê²Œì‹œíŒì˜ ì²¨ë¶€íŒŒì¼ ê²½ë¡œ ë“±

<br>
<br>

### **CASCADEì˜ ì¢…ë¥˜**

<br>

| ì¢…ë¥˜ | ìƒì„¸ |
| --- | --- |
| ALL | ëª¨ë‘ ì ìš© |
| PERSIST | ì˜ì† |
| REMOVE | ì‚­ì œ |
| MERGE | ë³‘í•© |
| REFREPSH | Refresh |
| DETACH | Detach |
- ë³´í†µ ì´ ì¤‘ ALL, PERSIST ì‚¬ìš©

<br>
<br>

## **04. ê³ ì•„ ê°ì²´**

<br>

### **ê³ ì•„ ê°ì²´**

<br>

- ê³ ì•„ ê°ì²´ ì œê±°: ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê³„ê°€ ëŠì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œ
- `orphanRemoval = true`

```java
Parent parent1 = em.find(Parent.class, id);
parent1.getChildren().remove(0); //ìì‹ ì—”í‹°í‹°ë¥¼ ì»¬ë ‰ì…˜ì—ì„œ ì œê±°

// Delete ì¿¼ë¦¬ê°€ ë‚˜ê°
DELETE FROM CHILD WHERE ID=?
```

ì˜ˆì œ

```java

@Entity
public class Parent {

    @Id
    @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent", cascade = CascadeType.ALL, orphanRemoval = true)
    private List<Child> childList = new ArrayList<>();
		// parentê°€ ì§€ì›Œì§€ë©´ ê·¸ í•˜ìœ„ childListì— ìˆëŠ” childë„ ì§€ì›Œì§„ë‹¤

    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    // getter, setter (ìƒëµ)

}
```

```java
// JpaMain.java

Child child1 = new Child();
Child child2 = new Child();

Parent parent = new Parent();
parent.addChild(child1);
parent.addChild(child2);

em.persist(parent);

em.flush();
em.clear();

Parent findParent = em.find(Parent.class, parent.getId());
findParent.getChildList().remove(0); // ë¶€ëª¨ ì œê±° -> orphanRemovalì´ ë™ì‘

tx.commit();

```

```java
Hibernate: 
    /* insert hellojpa.Parent
        */ insert 
        into
            Parent
            (name, id) 
        values
            (?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    select
        parent0_.id as id1_7_0_,
        parent0_.name as name2_7_0_ 
    from
        Parent parent0_ 
    where
        parent0_.id=?
Hibernate: 
    select
        childlist0_.parent_id as parent_i3_2_0_,
        childlist0_.id as id1_2_0_,
        childlist0_.id as id1_2_1_,
        childlist0_.name as name2_2_1_,
        childlist0_.parent_id as parent_i3_2_1_ 
    from
        Child childlist0_ 
    where
        childlist0_.parent_id=?
Hibernate: 
    /* delete hellojpa.Child */ delete 
        from
            Child 
        where
            id=?
```

<br>

>ğŸš¨ **ì£¼ì˜**
>
>- ì°¸ì¡°ê°€ ì œê±°ëœ ì—”í‹°í‹°ëŠ” ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê³ ì•„ ê°ì²´ë¡œ ë³´ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥
>- ì°¸ì¡°í•˜ëŠ” ê³³ì´ í•˜ë‚˜ì¼ ë•Œ ì‚¬ìš©í•´ì•¼í•¨!
>- â­ï¸ íŠ¹ì • ì—”í‹°í‹°ê°€ ê°œì¸ ì†Œìœ í•  ë•Œ ì‚¬ìš©
>- `@OneToOne`, `@OneToMany`ë§Œ ê°€ëŠ¥
>- ì°¸ê³  : ê°œë…ì ìœ¼ë¡œ ë¶€ëª¨ë¥¼ ì œê±°í•˜ë©´ ìì‹ì€ ê³ ì•„ê°€ ëœë‹¤. ë”°ë¼ì„œ ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ì„ í™œì„±í™” í•˜ë©´, ë¶€ëª¨ë¥¼ ì œê±°í•  ë•Œ ìì‹ë„ í•¨ê»˜ ì œê±°ëœë‹¤. ì´ê²ƒì€ `CascadeType.REMOVE`ì²˜ëŸ¼ ë™ì‘í•œë‹¤.

<br>

CascadeType ì§€ì • ì•ˆí•˜ë©´ childë„ ê°ê° persist í•´ì¤˜ì•¼ ,, (ì•ˆí•˜ë©´ parentë§Œ delete ë¨)

```java

@Entity
public class Parent {

    @Id
    @GeneratedValue
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent", orphanRemoval = true)
    private List<Child> childList = new ArrayList<>();

    public void addChild(Child child) {
        childList.add(child);
        child.setParent(this);
    }

    // getter, setter (ìƒëµ)

}
```

```java
// JpaMain.java

Child child1 = new Child();
Child child2 = new Child();

Parent parent = new Parent();
parent.addChild(child1);
parent.addChild(child2);

em.persist(parent);
em.persist(child1);
em.persist(child2);

em.flush();
em.clear();

Parent findParent = em.find(Parent.class, parent.getId());
em.remove(findParent);

tx.commit();
```

```java
Hibernate: 
    /* insert hellojpa.Parent
        */ insert 
        into
            Parent
            (name, id) 
        values
            (?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    /* insert hellojpa.Child
        */ insert 
        into
            Child
            (name, parent_id, id) 
        values
            (?, ?, ?)
Hibernate: 
    select
        parent0_.id as id1_7_0_,
        parent0_.name as name2_7_0_ 
    from
        Parent parent0_ 
    where
        parent0_.id=?
Hibernate: 
    select
        childlist0_.parent_id as parent_i3_2_0_,
        childlist0_.id as id1_2_0_,
        childlist0_.id as id1_2_1_,
        childlist0_.name as name2_2_1_,
        childlist0_.parent_id as parent_i3_2_1_ 
    from
        Child childlist0_ 
    where
        childlist0_.parent_id=?
Hibernate: 
    /* delete hellojpa.Child */ delete 
        from
            Child 
        where
            id=?
Hibernate: 
    /* delete hellojpa.Child */ delete 
        from
            Child 
        where
            id=?
Hibernate: 
    /* delete hellojpa.Parent */ delete 
        from
            Parent 
        where
            id=?
```

<br>
<br>

## **05. ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´, ìƒëª… ì£¼ê¸°**

<br>

### **ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´, ìƒëª…ì£¼ê¸°**

<br>

- `CascadeType.ALL` + `orphanRemoval=true`
- ìŠ¤ìŠ¤ë¡œ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°ëŠ” `em.persist()`ë¡œ ì˜ì†í™”, `em.remove()`ë¡œ ì œê±°
- ë‘ ì˜µì…˜ì„ ëª¨ë‘ í™œì„±í™” í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ í†µí•´ì„œ ìì‹ì˜ ìƒëª… ì£¼ê¸°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ
- ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„(DDD)ì˜ Aggregate Rootê°œë…ì„ êµ¬í˜„í•  ë•Œ ìœ ìš©